---
import MainLayout from '../layouts/MainLayout.astro';
import SocialList from '../components/SocialList.astro';
import PostPreview from '../components/blog/PostPreview.astro';
import { getAllPosts } from '../data/post';
import { collectionDateSort } from '../utils/date';

const MAX_PINNED = 3;
const MAX_RECENT = 5;

const allPosts = await getAllPosts();
const sortedPosts = allPosts.sort(collectionDateSort);
const pinnedPosts = sortedPosts.filter((p) => p.data.pinned).slice(0, MAX_PINNED);
const recentPosts = sortedPosts.slice(0, MAX_RECENT);
---

<MainLayout title="Home">
  <section>
    <h1 class="mb-12 text-2xl font-bold text-zinc-900 dark:text-[#e4f0fb]">#human_centric_DX</h1>
    
    <p class="mb-4 font-sans text-zinc-700 dark:text-[#e4f0fb] leading-relaxed">
      ここに本文が入ります。
    </p>
    
    <SocialList />
  </section>

  {pinnedPosts.length > 0 && (
    <section class="mt-16">
      <h2 class="mb-6 text-xl font-bold text-zinc-900 dark:text-[#e4f0fb]">Pinned Posts</h2>
      <ul class="space-y-4" role="list">
        {pinnedPosts.map((p) => (
          <li class="grid gap-1 sm:grid-cols-[auto_1fr] items-baseline">
            <PostPreview post={p} />
          </li>
        ))}
      </ul>
    </section>
  )}

  <section class="mt-16">
    <h2 class="mb-6 text-xl font-bold text-[#d0679d] dark:text-[#5de4c7]">
      <a href="/posts/">Posts</a>
    </h2>
    <ul class="space-y-4" role="list">
      {recentPosts.map((p) => (
        <li class="grid gap-1 sm:grid-cols-[auto_1fr] items-baseline">
          <PostPreview post={p} />
        </li>
      ))}
    </ul>
  </section>
</MainLayout>
